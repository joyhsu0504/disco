SLURM_JOBID=3789580
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam2
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001.pt
Entropy threshold 0.0001
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.008222292273057975
200 0.0010195625691085297
300 0.0010117605181039835
Starting epoch 2
400 0.0003483933143070317
500 0.013000333861218677
600 0.026867173344435287
700 0.005900535152686643
Starting epoch 3
800 0.0030305871654854855
900 0.0013856167992344127
1000 0.003965506655422359
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.99909338168631
Checking validation accuracy ...
val accuracy is  0.9141866279538673
total counted in batch average is 37.2314629258517
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_1.pt
1100 0.005590146784707031
Starting epoch 4
1200 0.00484307663542495
1300 0.0004477516838232987
1400 0.00027681819999088477
1500 0.0026876767906651366
Starting epoch 5
1600 0.0003991804059842252
1700 0.0006858062903756945
1800 0.0005047984830980568
1900 0.0002027160045781784
Starting epoch 6
2000 0.00018758189728941942
Checking training accuracy ... 
train accuracy is 0.9999395587790874
Checking validation accuracy ...
val accuracy is  0.9260424227760303
total counted in batch average is 40.212637913741226
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_2.pt
2100 7.950330586027121e-05
2200 0.00010262964996854862
2300 5.478540499098017e-05
Starting epoch 7
2400 3.140881241506577e-05
2500 4.899482788914611e-05
2600 3.164448468851333e-05
2700 0.00020314125099957892
Starting epoch 8
2800 0.07081646567475218
2900 0.03311098503225367
3000 0.006505899752264668
Checking training accuracy ... 
train accuracy is 0.9982874987408079
Checking validation accuracy ...
val accuracy is  0.8839422534075329
total counted in batch average is 43.20741482965932
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_3.pt
3100 0.011137540753843496
Starting epoch 9
3200 0.004005813425246743
3300 0.003084538701841666
3400 0.001471349711137009
Starting epoch 10
3500 0.0019301944548351458
3600 0.0015890780606423504
3700 0.003769937037232012
3800 0.006558830350477365
Starting epoch 11
3900 0.004549891867191036
4000 0.000697088014185283
Checking training accuracy ... 
train accuracy is 0.9997783821899869
Checking validation accuracy ...
val accuracy is  0.9202355028631342
total counted in batch average is 32.57873620862588
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_4.pt
4100 0.00034571031903396943
4200 0.0004125828321684821
Starting epoch 12
4300 0.0012056027929429546
4400 0.000107381266034281
4500 0.001299571461040614
4600 0.00018081651075590343
Starting epoch 13
4700 0.00034057160765769366
4800 0.00012586756994096505
4900 0.00027779362671935813
5000 0.01483583716542853
Checking training accuracy ... 
train accuracy is 0.995164702326987
Checking validation accuracy ...
val accuracy is  0.8938624082587305
total counted in batch average is 40.666332665330664
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_5.pt
Starting epoch 14
5100 0.025420524315341027
5200 0.010014689453455503
5300 0.002039118733282521
5400 0.0004893335231645324
Starting epoch 15
5500 0.0005513789247561363
5600 0.00023685225498411454
5700 0.00014366853510182408
5800 0.001448640007697577
Starting epoch 16
5900 0.008982880494295386
6000 0.0028673454013733134
Checking training accuracy ... 
train accuracy is 0.999637352674524
Checking validation accuracy ...
val accuracy is  0.9079764497136866
total counted in batch average is 35.35105315947843
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_6.pt
6100 0.006070081516436403
6200 0.0014195325756736566
Starting epoch 17
6300 0.00036466522176851866
6400 0.004385895821269514
6500 0.009715008625080372
Starting epoch 18
6600 0.0038766149534421855
6700 0.0014926671943612745
6800 0.005928517957745499
6900 0.0052857228905486405
Starting epoch 19
7000 0.008368754177317896
Checking training accuracy ... 
train accuracy is 0.998327792888083
Checking validation accuracy ...
val accuracy is  0.9117670779901605
total counted in batch average is 36.09327983951856
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_7.pt
7100 0.004111222326191637
7200 0.002258189901967853
7300 0.0033862689413399496
Starting epoch 20
7400 0.004685585171482671
7500 0.0020033376883475283
7600 0.0008559133687049325
7700 0.0004012759562192514
Starting epoch 21
7800 0.00012659897431149147
7900 0.0001257639443019798
8000 8.129431810630194e-05
Checking training accuracy ... 
train accuracy is 1.0
Checking validation accuracy ...
val accuracy is  0.9342688926526332
total counted in batch average is 41.26452905811623
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_8.pt
8100 8.925270767122128e-05
Starting epoch 22
8200 5.0564503726491236e-05
8300 4.484728702209395e-05
8400 4.869721331033361e-05
8500 0.00014007303494054213
Starting epoch 23
8600 0.014292418074428498
8700 0.01869015954227507
8800 0.008158494751041872
8900 0.0059172881878839685
Starting epoch 24
9000 0.0013839598716367618
Checking training accuracy ... 
train accuracy is 0.9994358819381485
Checking validation accuracy ...
val accuracy is  0.909912089684652
total counted in batch average is 41.28786359077232
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_9.pt
9100 0.003306856382132537
9200 0.0005307561469362554
9300 0.00274213684408096
Starting epoch 25
9400 0.0003311586600830196
9500 0.00028393677037456653
9600 0.004310487240873045
Starting epoch 26
9800 0.005002148019375454
9900 0.010053268769534043
10000 0.0014623657163065219
Checking training accuracy ... 
train accuracy is 0.9997179409690743
Checking validation accuracy ...
val accuracy is  0.9053149447536092
total counted in batch average is 37.89178356713427
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_10.pt
Starting epoch 27
10100 0.001494426606932393
10200 0.00013925207518695971
10300 0.0003491848085741367
10400 0.0004903845488843217
Starting epoch 28
10500 0.0038559821192757225
10600 0.004091969299006451
10700 0.003503114929735602
10800 0.0016425883826195785
Starting epoch 29
10900 0.0009033204802744876
11000 0.0005137469183227949
Checking training accuracy ... 
train accuracy is 0.9994761760854236
Checking validation accuracy ...
val accuracy is  0.9063634164045488
total counted in batch average is 43.0641925777332
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_11.pt
11100 0.01069541130131256
11200 0.0007055427531395253
Starting epoch 30
11300 0.00040492303843166157
11400 0.0029391458842019345
11500 0.0002861005804788874
11600 0.00023764582721469196
Starting epoch 31
11700 0.00026941055268252966
11800 0.00011903689427072095
11900 4.9810429550234404e-05
12000 0.00029231320799453896
Checking training accuracy ... 
train accuracy is 0.9998388234108996
Checking validation accuracy ...
val accuracy is  0.9237841761432374
total counted in batch average is 44.017034068136276
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_12.pt
Starting epoch 32
12100 0.00048449035473367984
12200 0.00013512119690858526
12300 0.0001523285300027055
12400 0.0001705614010620593
Starting epoch 33
12500 7.303748601771076e-05
12600 5.4690562933501496e-05
12700 7.242971107416451e-05
12800 0.0024572889711589594
Starting epoch 34
12900 0.06340702133396917
13000 0.018299604749008724
Checking training accuracy ... 
train accuracy is 0.998146469225345
Checking validation accuracy ...
val accuracy is  0.8999112831679974
total counted in batch average is 46.952858575727184
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_13.pt
13100 0.007402016514242859
Starting epoch 35
13200 0.0009839535484388762
13300 0.0010580354264493508
13400 0.0013976617946536863
13500 0.0005807830952926452
Starting epoch 36
13600 0.0010405500565320836
13700 0.002205852491024416
13800 0.0005613735864608316
13900 0.0006487146571362246
Starting epoch 37
14000 0.0004903542524334625
Checking training accuracy ... 
train accuracy is 0.9997985292636244
Checking validation accuracy ...
val accuracy is  0.9274941527542544
total counted in batch average is 33.56068204613842
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_14.pt
14100 0.00011166780603161897
14200 0.00041492436798762355
14300 0.0005702204026601976
Starting epoch 38
14400 0.0002136701878043823
14500 0.0008548873808922508
14600 0.00020868003608484286
14700 0.00010390606849796314
Starting epoch 39
14800 9.937533639458706e-05
14900 9.095002305002709e-05
15000 4.1651987562545404e-05
Checking training accuracy ... 
train accuracy is 0.9999395587790874
Checking validation accuracy ...
val accuracy is  0.9308008710379869
total counted in batch average is 43.95190380761523
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_15.pt
15100 0.00041762212767935123
Starting epoch 40
15200 0.0002041972155620897
15300 0.0006775022162946697
15400 0.00017264325068481413
15500 0.008681348460688696
Starting epoch 41
15600 0.014877871702683478
15700 0.000948809762539895
15800 0.0014948178349004594
15900 0.0006949123397680523
Starting epoch 42
16000 0.0014955878594082605
Checking training accuracy ... 
train accuracy is 0.9997582351163493
Checking validation accuracy ...
val accuracy is  0.9226550528268409
total counted in batch average is 45.08224674022066
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_16.pt
16100 0.003988191129947154
16200 0.003501922317154822
Starting epoch 43
16300 0.0003215905026263499
16400 0.0001236570007586124
16500 0.0001111037426198891
16600 0.0001057259941671873
Starting epoch 44
16700 0.0023449481368561466
16800 0.00017990423913033738
16900 0.00011979154790878965
17000 8.312882870995963e-05
Checking training accuracy ... 
train accuracy is 1.0
Checking validation accuracy ...
val accuracy is  0.9392692959109605
total counted in batch average is 47.7685370741483
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_17.pt
Starting epoch 45
17100 0.009236458282825879
17200 0.001001946268061147
17300 0.00019597356085341745
17400 0.00013730092490277457
Starting epoch 46
17500 0.00029997407227710937
17600 0.0022514357683894558
17700 0.0037819329299327363
17800 0.01561472794835936
Starting epoch 47
17900 0.003930798147794121
18000 0.0054346503266333454
Checking training accuracy ... 
train accuracy is 0.9990329404653974
Checking validation accuracy ...
val accuracy is  0.9308008710379869
total counted in batch average is 47.64393179538616
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_18.pt
18100 0.011573325227091117
18200 0.002796685562952916
Starting epoch 48
18300 0.0039529627434967555
18400 0.0002513619477940665
18500 0.0001657415932186268
18600 0.0003838611983883311
Starting epoch 49
18700 0.0006180561194196343
18800 0.00022876729226481985
18900 0.0010675539482053863
19000 0.00022790679205172637
Checking training accuracy ... 
train accuracy is 1.0
Checking validation accuracy ...
val accuracy is  0.933784982659892
total counted in batch average is 44.70440881763527
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0001_19.pt
Starting epoch 50
19100 0.00011949838459713646
19200 5.6007591911111374e-05
19300 7.897211412000616e-05
Starting epoch 51
19500 0.00010282395752710727
19600 3.9436294664483284e-05
19700 3.365766971455742e-05
Starting epoch 52
19800 3.4997243806174086e-05
19900 3.231376231951799e-05
20000 1.8476139052836517e-05
Checking training accuracy ... 
