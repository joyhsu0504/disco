SLURM_JOBID=3789581
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam2
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005.pt
Entropy threshold 0.0005
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.0008134347358691229
200 0.008662636334120179
300 0.01775274156991145
Starting epoch 2
400 0.0017920955397312355
500 0.00010775494597055513
600 0.000140640497397726
700 0.00015451762097427491
Starting epoch 3
800 7.353884190024474e-05
900 3.532766805392384e-05
1000 0.00016119588751678293
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.9980054397098821
Checking validation accuracy ...
val accuracy is  0.935962577627228
total counted in batch average is 72.4498997995992
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_1.pt
1100 0.018082080002222937
Starting epoch 4
1200 0.009858755460281827
1300 0.010640625649684807
1400 0.0011037126606879611
1500 0.0034118784756083185
Starting epoch 5
1600 0.00030432878157625964
1700 0.000728878159964097
1800 0.0026903343562253213
1900 6.234317158032354e-05
Starting epoch 6
2000 0.0023110660606562305
Checking training accuracy ... 
train accuracy is 0.9999597058527249
Checking validation accuracy ...
val accuracy is  0.9429792725219776
total counted in batch average is 65.98094282848545
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_2.pt
2100 0.0002121170498094216
2200 2.157666844141204e-05
2300 0.000107322642767258
Starting epoch 7
2400 0.004776870662634564
2500 0.007620756512851585
2600 0.004349706755251645
2700 0.006055448544502724
Starting epoch 8
2800 0.0007328782841477732
2900 0.0005304958029500995
3000 0.0005915158878133297
Checking training accuracy ... 
train accuracy is 0.9998589704845371
Checking validation accuracy ...
val accuracy is  0.9380595209291072
total counted in batch average is 74.78957915831663
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_3.pt
3100 0.001706387268198455
Starting epoch 9
3200 0.0006209339592476226
3300 0.0019630877986969606
3400 0.0021453851631599717
Starting epoch 10
3500 0.0003672967598390642
3600 0.005747691207620847
3700 0.0047332442164452005
3800 0.003395514747737707
Starting epoch 11
3900 0.00035913181069872733
4000 0.00011172326065320704
Checking training accuracy ... 
train accuracy is 0.9999798529263625
Checking validation accuracy ...
val accuracy is  0.9353980159690297
total counted in batch average is 78.31093279839519
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_4.pt
4100 0.003887095884948053
4200 0.004474010090214051
Starting epoch 12
4300 0.0006757367892089405
4400 0.007051592765016039
4500 0.0036428430080150064
4600 0.0006552599963629291
Starting epoch 13
4700 0.0012332984161048445
4800 0.0015456526300101814
4900 0.0017619424724216516
5000 0.0018550350438545139
Checking training accuracy ... 
train accuracy is 0.9998992646318122
Checking validation accuracy ...
val accuracy is  0.9318493426889265
total counted in batch average is 78.79258517034069
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_5.pt
Starting epoch 14
5100 6.101638693507994e-05
5200 0.00405475088325943
5300 0.0029337633755949356
5400 0.0002035297726342833
Starting epoch 15
5500 0.00040100139843389114
5600 0.00010077863777496532
5700 4.665078958481672e-05
5800 0.005609458887818164
Starting epoch 16
5900 0.013735459851704945
6000 0.006959767642838415
Checking training accuracy ... 
train accuracy is 0.9994963231590611
Checking validation accuracy ...
val accuracy is  0.9268489394305992
total counted in batch average is 84.35105315947844
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_6.pt
6100 0.0032274725286151806
6200 0.0022791218529960135
Starting epoch 17
6300 0.0016800893297101993
6400 0.0003051549240217355
6500 0.0010567467317366664
Starting epoch 18
6600 0.0027796609464360244
6700 0.0014254351357021733
6800 0.00033074694399203963
6900 4.564205212545858e-05
Starting epoch 19
7000 0.0007700354402982157
Checking training accuracy ... 
train accuracy is 0.9993149994963232
Checking validation accuracy ...
val accuracy is  0.9272521977578837
total counted in batch average is 82.63189568706119
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_7.pt
7100 0.01570816591802668
7200 0.0042980720576770185
7300 0.0014719929599823446
Starting epoch 20
7400 0.0009087135592210416
7500 0.0003929743785084838
7600 0.0009079788609079742
7700 0.0005602429029090672
Starting epoch 21
7800 0.004546015457749491
7900 0.006359829624163922
8000 9.22093911765387e-05
Checking training accuracy ... 
train accuracy is 0.9998791175581747
Checking validation accuracy ...
val accuracy is  0.9336236793289782
total counted in batch average is 79.25350701402806
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_8.pt
8100 0.005767055128650327
Starting epoch 22
8200 0.0022039030523683324
8300 0.0005115746668957399
8400 0.0022213289605247156
8500 0.001231430600666954
Starting epoch 23
8600 0.0025257819791272597
8700 0.0020068667367434045
8800 0.001414086583271228
8900 0.00014971567707391386
Starting epoch 24
9000 0.0006164643371189981
Checking training accuracy ... 
train accuracy is 0.9996776468217992
Checking validation accuracy ...
val accuracy is  0.9458020808129688
total counted in batch average is 83.32597793380141
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_9.pt
9100 0.0041329952538228555
9200 7.550793513132704e-05
9300 0.00022575164397977687
Starting epoch 25
9400 0.0018947205959403846
9500 0.001350973733545402
9600 0.00013238758407084107
Starting epoch 26
9800 0.003533010224088429
9900 0.010428878984182575
10000 0.008356825392376095
Checking training accuracy ... 
train accuracy is 0.999637352674524
Checking validation accuracy ...
val accuracy is  0.9342688926526332
total counted in batch average is 87.53306613226452
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_10.pt
Starting epoch 27
10100 0.0003588231225359095
10200 0.0014458493725453536
10300 0.002316714038119585
10400 0.00023027018253230836
Starting epoch 28
10500 0.001568794444773971
10600 0.001623093141683114
10700 0.00023564648947512978
10800 0.00014828254096045158
Starting epoch 29
10900 0.00483567360064427
11000 0.003938721201229782
Checking training accuracy ... 
train accuracy is 0.9999194117054497
Checking validation accuracy ...
val accuracy is  0.9439470925074602
total counted in batch average is 85.04012036108325
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_11.pt
11100 0.00042176090767895855
11200 0.0008984771326714736
Starting epoch 30
11300 0.00013416145303096983
11400 0.0031267337078324433
11500 0.0014884508958627406
11600 0.0023033503874108872
Starting epoch 31
11700 0.0020962471944790196
11800 0.002696515592847959
11900 0.0025340240740558784
12000 0.0021254906492293914
Checking training accuracy ... 
train accuracy is 0.9997380880427118
Checking validation accuracy ...
val accuracy is  0.9312041293652714
total counted in batch average is 87.70541082164328
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_12.pt
Starting epoch 32
12100 0.0022684016191703905
12200 7.530088740736573e-05
12300 0.0008209280065048574
12400 0.0009046855412140075
Starting epoch 33
12500 0.0005597134935166536
12600 2.1911791964726035e-05
12700 0.00022058139855374748
12800 0.001446617374221546
Starting epoch 34
12900 0.0018638966809037072
13000 0.0007863329391807383
Checking training accuracy ... 
train accuracy is 0.9998992646318122
Checking validation accuracy ...
val accuracy is  0.9441890475038309
total counted in batch average is 92.09528585757272
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_13.pt
13100 0.010006677483083877
Starting epoch 35
13200 0.001272383577961591
13300 0.0006475923079995027
13400 0.0001736184430637877
13500 9.124034359558663e-05
Starting epoch 36
13600 0.00012943387515321092
13700 0.001004748434277758
13800 0.0006041071039885538
13900 0.004364717350290164
Starting epoch 37
14000 0.002085053378588668
Checking training accuracy ... 
train accuracy is 0.999053087539035
Checking validation accuracy ...
val accuracy is  0.9474957657875636
total counted in batch average is 90.21263791374122
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_14.pt
14100 0.0036883343914342957
14200 0.0001074378372369722
14300 0.003822461042063594
Starting epoch 38
14400 4.7228401800794014e-05
14500 0.0006262776139553239
14600 0.0034834510296172993
14700 0.003185421874857752
Starting epoch 39
14800 0.0016248867643935227
14900 0.003617767846164384
15000 0.0031080194984767218
Checking training accuracy ... 
train accuracy is 0.9998388234108996
Checking validation accuracy ...
val accuracy is  0.9520122590531495
total counted in batch average is 91.31963927855712
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_15.pt
15100 0.004865553353756696
Starting epoch 40
15200 0.0002545608819295353
15300 0.00038090226703218377
15400 0.000376518189583237
15500 0.000767012920550485
Starting epoch 41
15600 0.00015175089669597241
15700 0.0016868614607682276
15800 0.002600132242409927
15900 0.0025223268841600087
Starting epoch 42
16000 0.0009170068102719142
Checking training accuracy ... 
train accuracy is 0.9999597058527249
Checking validation accuracy ...
val accuracy is  0.9498346640858134
total counted in batch average is 91.98896690070211
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_16.pt
16100 7.401887497223924e-05
16200 0.00121585020510679
Starting epoch 43
16300 4.994359015412897e-05
16400 1.0446690180145878e-05
16500 1.5404787036032985e-05
16600 0.00012412670522408576
Starting epoch 44
16700 0.009605953390630475
16800 0.0010982202141227048
16900 0.0003989887680367588
17000 0.0058794947779168185
Checking training accuracy ... 
train accuracy is 0.9996574997481615
Checking validation accuracy ...
val accuracy is  0.9483022824421324
total counted in batch average is 93.37575150300601
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_17.pt
Starting epoch 45
17100 0.001015271001484166
17200 0.0014778303726697573
17300 6.625934043938742e-05
17400 7.965897191915872e-05
Starting epoch 46
17500 2.0778272979669054e-05
17600 8.708347759167622e-06
17700 2.112542744946211e-05
17800 6.419317981851691e-06
Starting epoch 47
17900 1.3315692832946979e-05
18000 0.00012530473424192225
Checking training accuracy ... 
train accuracy is 1.0
Checking validation accuracy ...
val accuracy is  0.9532220340350028
total counted in batch average is 97.03309929789368
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_18.pt
18100 4.844148900403411e-05
18200 2.1154238441738472e-05
Starting epoch 48
18300 1.93654078009331e-05
18400 2.269144992794736e-06
18500 0.013991146450191536
18600 0.018442544931778004
Starting epoch 49
18700 0.0004611238175920107
18800 0.0001196868879466706
18900 0.0017067849309012218
19000 0.0011430406088410905
Checking training accuracy ... 
train accuracy is 0.9999798529263625
Checking validation accuracy ...
val accuracy is  0.947818372449391
total counted in batch average is 93.70240480961924
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t0005_19.pt
Starting epoch 50
19100 0.00036981927610781897
19200 7.715632795310512e-05
19300 3.16241770977399e-05
Starting epoch 51
19500 1.729984529355022e-05
19600 3.521411585865053e-06
19700 6.958184816241441e-06
Starting epoch 52
19800 3.739173206213309e-05
19900 3.275269287705385e-05
