SLURM_JOBID=3789583
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam4
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01.pt
Entropy threshold 0.01
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.004985119526172639
200 0.006014623378910074
300 0.011172253839947643
Starting epoch 2
400 0.003783788615553476
500 0.006475607704937829
600 0.004179526791789385
700 0.005638770843828525
Starting epoch 3
800 0.012421410249818337
900 0.0063499141101621605
1000 0.009596534027720125
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.9997783821899869
Checking validation accuracy ...
val accuracy is  0.9445923058311154
total counted in batch average is 108.64028056112224
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_1.pt
1100 0.0019585500507331233
Starting epoch 4
1200 0.0018011793240656005
1300 0.005227629249264254
1400 0.0032342670237368054
1500 0.007450124499535686
Starting epoch 5
1600 0.008064028955004935
1700 0.001826120013959951
1800 0.004135527199944597
1900 0.016718729970659457
Starting epoch 6
2000 0.004552815756868753
Checking training accuracy ... 
train accuracy is 0.9992948524226856
Checking validation accuracy ...
val accuracy is  0.9372530042745383
total counted in batch average is 117.34202607823471
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_2.pt
2100 0.006313613574785854
2200 0.0048709081350699224
2300 0.003319982954737282
Starting epoch 7
2400 0.0026243976541089785
2500 0.007815637892237054
2600 0.011377070490759547
2700 0.005454684026372183
Starting epoch 8
2800 0.005308853631308566
2900 0.0048930419640041386
3000 0.003574079648392601
Checking training accuracy ... 
train accuracy is 0.9995970585272489
Checking validation accuracy ...
val accuracy is  0.9250746027905477
total counted in batch average is 118.14929859719439
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_3.pt
3100 0.00305954691226651
Starting epoch 9
3200 0.008154764502983794
3300 0.004082473258953754
3400 0.010310027080115334
Starting epoch 10
3500 0.005438499086482784
3600 0.006015144423374053
3700 0.005341942972436855
3800 0.0034017434973162676
Starting epoch 11
3900 0.005100551192819305
4000 0.01108007915728051
Checking training accuracy ... 
train accuracy is 0.9997179409690743
Checking validation accuracy ...
val accuracy is  0.9355593192999435
total counted in batch average is 119.25576730190572
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_4.pt
4100 0.005381447568489865
4200 0.0062779564119371575
Starting epoch 12
4300 0.0034275285756155726
4400 0.002586926515545771
4500 0.006953768911598565
4600 0.007919260933147548
Starting epoch 13
4700 0.003727065225153756
4800 0.005525569417039538
4900 0.005243505354283857
5000 0.0026492514688359805
Checking training accuracy ... 
train accuracy is 0.9996172056008865
Checking validation accuracy ...
val accuracy is  0.9330591176707799
total counted in batch average is 119.98196392785572
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_5.pt
Starting epoch 14
5100 0.010952517528320542
5200 0.012710213308514467
5300 0.00395084939282669
5400 0.00908076541512728
Starting epoch 15
5500 0.005321225360025492
5600 0.002627522058836587
5700 0.0070888139115893815
5800 0.004586782767238471
Starting epoch 16
5900 0.008801577815744975
6000 0.0056901825488817285
Checking training accuracy ... 
train accuracy is 0.9995366173063363
Checking validation accuracy ...
val accuracy is  0.9399145092346157
total counted in batch average is 120.75225677031094
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_6.pt
6100 0.007042162576305354
6200 0.006082831013559172
Starting epoch 17
6300 0.004333014510723944
6400 0.009277993033383957
6500 0.005323381069381408
Starting epoch 18
6600 0.0008688215759513173
6700 0.0031008254366550548
6800 0.0077933994223970526
6900 0.005278785869116537
Starting epoch 19
7000 0.0006986648656172134
Checking training accuracy ... 
train accuracy is 0.9997582351163493
Checking validation accuracy ...
val accuracy is  0.9556415839987096
total counted in batch average is 121.2998996990973
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_7.pt
7100 0.004833612595276213
7200 0.009127602091396736
7300 0.009246052683933003
Starting epoch 20
7400 0.00532079287987263
7500 0.0038513464956464395
7600 0.0028460178945109004
7700 0.002102940016004207
Starting epoch 21
7800 0.00518567048914915
7900 0.006083415026701024
8000 0.007318984464338727
Checking training accuracy ... 
train accuracy is 0.9994761760854236
Checking validation accuracy ...
val accuracy is  0.9324945560125817
total counted in batch average is 121.22344689378758
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_8.pt
8100 0.004441249187668841
Starting epoch 22
8200 0.0017479190415732803
8300 0.005874462898165197
8400 0.00820979459732123
8500 0.007826004596986203
Starting epoch 23
8600 0.004488893358043663
8700 0.00441279787846829
8800 0.0054815346185355
8900 0.0032930032289225954
Starting epoch 24
9000 0.0072543108795163945
Checking training accuracy ... 
train accuracy is 0.9995970585272489
Checking validation accuracy ...
val accuracy is  0.9335430276635213
total counted in batch average is 121.36710130391174
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_9.pt
9100 0.005810598433342715
9200 0.006263433339272337
9300 0.0064338208994016745
Starting epoch 25
9400 0.0028467751877769786
9500 0.007734124709355226
9600 0.0033140126589967854
Starting epoch 26
9800 0.0029470973529814996
9900 0.006259538140060123
10000 0.005755789241535335
Checking training accuracy ... 
train accuracy is 0.9988314697290218
Checking validation accuracy ...
val accuracy is  0.9446729574965723
total counted in batch average is 122.02404809619239
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_10.pt
Starting epoch 27
10100 0.006325321022154281
10200 0.00348646799574138
10300 0.007152340926877665
10400 0.0021900632815462506
Starting epoch 28
10500 0.0068899143545943535
10600 0.003367651660661586
10700 0.004289768123740132
10800 0.0028001080143944435
Starting epoch 29
10900 0.00455262014505037
11000 0.002835404540623859
Checking training accuracy ... 
train accuracy is 0.9995164702326987
Checking validation accuracy ...
val accuracy is  0.9490281474312444
total counted in batch average is 122.12437311935807
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_11.pt
11100 0.004897765332322716
11200 0.00482689513933507
Starting epoch 30
11300 0.0009274662371516174
11400 0.001471884830303981
11500 0.01576793440007921
11600 0.006964578738087562
Starting epoch 31
11700 0.002608284861791117
11800 0.00441307914156196
11900 0.0031247305750164013
12000 0.002452195851066923
Checking training accuracy ... 
train accuracy is 0.9995769114536114
Checking validation accuracy ...
val accuracy is  0.9376562626018228
total counted in batch average is 121.72545090180361
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_12.pt
Starting epoch 32
12100 0.002424066906729493
12200 0.0053016859497854
12300 0.006238560280181665
12400 0.010571872482909835
Starting epoch 33
12500 0.005341369123636751
12600 0.003623190117516961
12700 0.008534900587750567
12800 0.004924081675014196
Starting epoch 34
12900 0.0015966094726371195
13000 0.00741270032643172
Checking training accuracy ... 
train accuracy is 0.999818676337262
Checking validation accuracy ...
val accuracy is  0.9528187757077183
total counted in batch average is 122.28585757271816
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_13.pt
13100 0.0023705231116767857
Starting epoch 35
13200 0.0011878979339983652
13300 0.006665291704686774
13400 0.0008414254556335576
13500 0.001191728115695222
Starting epoch 36
13600 0.005310140964325298
13700 0.004680289012774152
13800 0.0031499815325674164
13900 0.0017829033830414026
Starting epoch 37
14000 0.006783936074589923
Checking training accuracy ... 
train accuracy is 0.9979651455626071
Checking validation accuracy ...
val accuracy is  0.9470925074602791
total counted in batch average is 122.6469408224674
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_14.pt
14100 0.008094409736706096
14200 0.0012192237142726625
14300 0.009302276363921622
Starting epoch 38
14400 0.0028456612142002857
14500 0.008807391226527118
14600 0.004647181611060636
14700 0.0047201445889016825
Starting epoch 39
14800 0.0013983985165329726
14900 0.003645320928267298
15000 0.0024094422323116538
Checking training accuracy ... 
train accuracy is 0.9997380880427118
Checking validation accuracy ...
val accuracy is  0.956770707315106
total counted in batch average is 122.56312625250501
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_15.pt
15100 0.007449741592916388
Starting epoch 40
15200 0.0019350813490084896
15300 0.007165490037662392
15400 0.0016147833779884934
15500 0.0028635231310442655
Starting epoch 41
15600 0.0015507430737480277
15700 0.0029681988121930338
15800 0.002892619744859034
15900 0.005610405407280421
Starting epoch 42
16000 0.002479433603003842
Checking training accuracy ... 
train accuracy is 0.9997582351163493
Checking validation accuracy ...
val accuracy is  0.9440277441729171
total counted in batch average is 122.94884653961886
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_16.pt
16100 0.0023366562404104427
16200 0.00396710272631774
Starting epoch 43
16300 0.0007554085727509807
16400 0.006253775165731269
16500 0.007216537837098802
16600 0.004544767235600357
Starting epoch 44
16700 0.0047321549098266556
16800 1.5352091104176013e-05
16900 0.007193931036602066
17000 0.005010727164056543
Checking training accuracy ... 
train accuracy is 0.9975219099425808
Checking validation accuracy ...
val accuracy is  0.9377369142672796
total counted in batch average is 123.27054108216433
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_17.pt
Starting epoch 45
17100 0.001008653506389524
17200 0.006303922619327563
17300 0.005151564562396851
17400 0.00035525053463919434
Starting epoch 46
17500 0.0013367444014112733
17600 0.006528280406217554
17700 0.003498952863487903
17800 0.0038206755867485178
Starting epoch 47
17900 0.00644455132686728
18000 0.022964776363357187
Checking training accuracy ... 
train accuracy is 0.9997985292636244
Checking validation accuracy ...
val accuracy is  0.957496572304218
total counted in batch average is 122.85656970912738
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_18.pt
18100 0.0037778795221839146
18200 0.0010212966452468708
Starting epoch 48
18300 0.006380754457019295
18400 0.001987774144088672
18500 0.001296834952109206
18600 0.002290813235043567
Starting epoch 49
18700 0.0029700847375892956
18800 0.005079470316244738
18900 0.003877845602701755
19000 0.0067065015316551445
Checking training accuracy ... 
train accuracy is 0.9997380880427118
Checking validation accuracy ...
val accuracy is  0.9536252923622873
total counted in batch average is 122.79158316633267
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_19.pt
Starting epoch 50
19100 0.008504488782238157
19200 0.004139291754116519
19300 0.00033951901033840823
Starting epoch 51
19500 0.004186465677673901
19600 0.0017511319176195471
19700 0.006022923357735648
Starting epoch 52
19800 0.004900292478574498
19900 0.0013997828509083243
20000 0.00821996826392995
Checking training accuracy ... 
train accuracy is 0.9995567643799738
Checking validation accuracy ...
val accuracy is  0.9557222356641665
total counted in batch average is 123.2457372116349
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_20.pt
20100 0.004782670440284265
Starting epoch 53
20200 0.0028759144001965654
20300 0.0012386671100800895
20400 0.006324661614965559
20500 0.005215349118079241
Starting epoch 54
20600 0.004592694849483519
20700 0.00624187187047335
20800 0.0007927862709928979
20900 0.002282120988865286
Starting epoch 55
21000 0.0011631303836830975
Checking training accuracy ... 
train accuracy is 0.9995567643799738
Checking validation accuracy ...
val accuracy is  0.9516896523913219
total counted in batch average is 123.36108324974924
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_21.pt
21100 0.0035117869062366316
21200 0.0033760631267571494
21300 0.003457850781790209
Starting epoch 56
21400 0.0027472441955768536
21500 0.0025742924628949304
21600 0.0031595642865102015
21700 0.0019717497656724548
Starting epoch 57
21800 0.0025370130641323473
21900 0.008965965710998093
22000 0.006140749019347418
Checking training accuracy ... 
train accuracy is 0.9996977938954367
Checking validation accuracy ...
val accuracy is  0.9519316073876926
total counted in batch average is 123.43286573146293
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_22.pt
22100 0.004149554828616988
Starting epoch 58
22200 0.0028501985758174154
22300 0.0025625916828962538
22400 0.0012410666454258745
22500 0.00766535373249801
Starting epoch 59
22600 0.007441831759364094
22700 0.0012159584886256526
22800 0.002842992103121569
Starting epoch 60
22900 0.0033182901054421097
23000 0.0038039240973963538
Checking training accuracy ... 
train accuracy is 0.9995769114536114
Checking validation accuracy ...
val accuracy is  0.955318977336882
total counted in batch average is 123.61183550651955
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t01_23.pt
23100 0.005505812732318283
23200 0.0034346129630149136
