SLURM_JOBID=3789584
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam4
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06.pt
Entropy threshold 0.06
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.012284011026213192
200 0.015839823496189637
300 0.017540732585052864
Starting epoch 2
400 0.020918479839467638
500 0.025553079899425485
600 0.03553461140452328
700 0.026270005032478706
Starting epoch 3
800 0.01813270377766173
900 0.02447209436087178
1000 0.0230202828184693
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.9973405862798429
Checking validation accuracy ...
val accuracy is  0.8690216952980079
total counted in batch average is 116.63527054108216
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_1.pt
1100 0.02014126969750464
Starting epoch 4
1200 0.028324443942805148
1300 0.026908766814846673
1400 0.033104955089720466
1500 0.027592607133733793
Starting epoch 5
1600 0.024705447967727424
1700 0.029797037841926582
1800 0.03960437947718145
1900 0.03133020329130502
Starting epoch 6
2000 0.031564584046220985
Checking training accuracy ... 
train accuracy is 0.9984889694771835
Checking validation accuracy ...
val accuracy is  0.929187837728849
total counted in batch average is 121.45636910732196
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_2.pt
2100 0.021407003891830954
2200 0.02670642142580271
2300 0.02985880000566354
Starting epoch 7
2400 0.013901290377027564
2500 0.01634209950927977
2600 0.02027382476623577
2700 0.025969622766365497
Starting epoch 8
2800 0.03125199285778974
2900 0.024664704074426592
3000 0.025770790301323458
Checking training accuracy ... 
train accuracy is 0.9958497028306639
Checking validation accuracy ...
val accuracy is  0.9056375514154368
total counted in batch average is 122.7374749498998
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_3.pt
3100 0.046676305166766595
Starting epoch 9
3200 0.018906654376236
3300 0.027240307015960336
3400 0.023780667319250704
Starting epoch 10
3500 0.03038687193763427
3600 0.022438217744178552
3700 0.03887880872125378
3800 0.026704451856059123
Starting epoch 11
3900 0.02374672701935294
4000 0.024026121624697812
Checking training accuracy ... 
train accuracy is 0.9988314697290218
Checking validation accuracy ...
val accuracy is  0.9199128962013066
total counted in batch average is 123.14242728184554
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_4.pt
4100 0.013422235798179418
4200 0.020557231052293342
Starting epoch 12
4300 0.024789413137689217
4400 0.029666047641029383
4500 0.01869173124912546
4600 0.018849816801999222
Starting epoch 13
4700 0.03494967398913915
4800 0.01726378220660616
4900 0.02864620993083427
5000 0.027066959973164124
Checking training accuracy ... 
train accuracy is 0.9990127933917599
Checking validation accuracy ...
val accuracy is  0.9052342930881523
total counted in batch average is 123.59018036072145
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_5.pt
Starting epoch 14
5100 0.024875442013487223
5200 0.031273125279896063
5300 0.023070225414083514
5400 0.032164116676874174
Starting epoch 15
5500 0.018482676732650617
5600 0.02012929675131289
5700 0.01699244433593734
5800 0.031190941480626684
Starting epoch 16
5900 0.01973633928008177
6000 0.01424391984450692
Checking training accuracy ... 
train accuracy is 0.9978644101944193
Checking validation accuracy ...
val accuracy is  0.8899104766513428
total counted in batch average is 123.91374122367101
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_6.pt
6100 0.033920128511243444
6200 0.03627411573253805
Starting epoch 17
6300 0.026878870387085686
6400 0.026364846263130622
6500 0.014202602667709585
Starting epoch 18
6600 0.016887525532546122
6700 0.04122230454057437
6800 0.029028536337783538
6900 0.023487640577513166
Starting epoch 19
7000 0.02232910713471284
Checking training accuracy ... 
train accuracy is 0.99719955676438
Checking validation accuracy ...
val accuracy is  0.8796677151383177
total counted in batch average is 123.95285857572718
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_7.pt
7100 0.021748790735811305
7200 0.04594005997449498
7300 0.030353363795439726
Starting epoch 20
7400 0.044650932685191644
7500 0.010964610525597641
7600 0.04982421469963656
7700 0.01967294830202453
Starting epoch 21
7800 0.01084491585959503
7900 0.023939262907885586
8000 0.02016175403340019
Checking training accuracy ... 
train accuracy is 0.9985695577717336
Checking validation accuracy ...
val accuracy is  0.9249132994596339
total counted in batch average is 124.14629258517034
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_8.pt
8100 0.020477492637399407
Starting epoch 22
8200 0.020728398417092942
8300 0.016134476219398678
8400 0.019095318638883408
8500 0.032944727533675
Starting epoch 23
8600 0.009264302149588817
8700 0.02389116401903283
8800 0.02736287715170655
8900 0.02448429276466503
Starting epoch 24
9000 0.05896350751084012
Checking training accuracy ... 
train accuracy is 0.9985897048453712
Checking validation accuracy ...
val accuracy is  0.9199128962013066
total counted in batch average is 124.76429287863591
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_9.pt
9100 0.014098114746029315
9200 0.017340617147434047
9300 0.008402774281208496
Starting epoch 25
9400 0.022099779345554182
9500 0.016752836666529537
9600 0.012604905899317035
Starting epoch 26
9800 0.03287860944124557
9900 0.02446677074144074
10000 0.015484302150015785
Checking training accuracy ... 
train accuracy is 0.9991135287599476
Checking validation accuracy ...
val accuracy is  0.9325752076780386
total counted in batch average is 125.312625250501
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_10.pt
Starting epoch 27
10100 0.015561201569454263
10200 0.008747768625184898
10300 0.020065780106283043
10400 0.021100531799907656
Starting epoch 28
10500 0.013180253843445532
10600 0.034745283292155794
10700 0.02057019031165357
10800 0.021113249311678697
Starting epoch 29
10900 0.02533268472821506
11000 0.03389503796673321
Checking training accuracy ... 
train accuracy is 0.9976427923844061
Checking validation accuracy ...
val accuracy is  0.9066053714009195
total counted in batch average is 125.2296890672016
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_11.pt
11100 0.01330903494431333
11200 0.014206544599812394
Starting epoch 30
11300 0.02584309855190692
11400 0.019376172760468734
11500 0.03475615490087332
11600 0.02299476530295693
Starting epoch 31
11700 0.015081802767751739
11800 0.010055871891368464
11900 0.021665559740202053
12000 0.023329847471237806
Checking training accuracy ... 
train accuracy is 0.99909338168631
Checking validation accuracy ...
val accuracy is  0.910637954673764
total counted in batch average is 125.32164328657315
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_12.pt
Starting epoch 32
12100 0.0202246055750107
12200 0.028072319822061837
12300 0.019379393834573273
12400 0.013864154930357702
Starting epoch 33
12500 0.020685777981482217
12600 0.014183319585900737
12700 0.017003069190123107
12800 0.01678329548097068
Starting epoch 34
12900 0.049060137319882874
13000 0.017111927862573147
Checking training accuracy ... 
train accuracy is 0.9992545582754105
Checking validation accuracy ...
val accuracy is  0.9118477296556173
total counted in batch average is 125.43630892678034
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_13.pt
13100 0.021351467509179996
Starting epoch 35
13200 0.02542389571388259
13300 0.011090371390666764
13400 0.010836659400556413
13500 0.01408092029140346
Starting epoch 36
13600 0.019189940813097377
13700 0.007597253933172558
13800 0.01381569648429132
13900 0.011578086574425238
Starting epoch 37
14000 0.024812103875103818
Checking training accuracy ... 
train accuracy is 0.9991941170544978
Checking validation accuracy ...
val accuracy is  0.9013630131462215
total counted in batch average is 125.56770310932798
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_14.pt
14100 0.015855542759508765
14200 0.014688587719119694
14300 0.019577689836821385
Starting epoch 38
14400 0.02319125496672474
14500 0.035934414599558574
14600 0.0170570238154412
14700 0.031030017545664878
Starting epoch 39
14800 0.03646950594196641
14900 0.03799160052103404
15000 0.02009266689979085
Checking training accuracy ... 
train accuracy is 0.9970786743225547
Checking validation accuracy ...
val accuracy is  0.8682958303088959
total counted in batch average is 125.15931863727455
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_15.pt
15100 0.027429148340469806
Starting epoch 40
15200 0.01885753782201557
15300 0.019323440159599997
15400 0.028318535708991927
15500 0.03122956723111505
Starting epoch 41
15600 0.03582406543632835
15700 0.030466326183311857
15800 0.018721674327644152
15900 0.011671656927790366
Starting epoch 42
16000 0.01796025405712282
Checking training accuracy ... 
train accuracy is 0.99719955676438
Checking validation accuracy ...
val accuracy is  0.905476248084523
total counted in batch average is 125.4543630892678
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_16.pt
16100 0.02841585728784108
16200 0.014864155781812199
Starting epoch 43
16300 0.0149392604790483
16400 0.011509038551046393
16500 0.030689855102369573
16600 0.03488404205005177
Starting epoch 44
16700 0.022435888935309282
16800 0.016994796868746814
16900 0.013892238896584905
17000 0.03207199003357224
Checking training accuracy ... 
train accuracy is 0.9988314697290218
Checking validation accuracy ...
val accuracy is  0.8668441003306718
total counted in batch average is 125.13827655310621
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_17.pt
Starting epoch 45
17100 0.016118016966592385
17200 0.014813987164623241
17300 0.042981382096747886
17400 0.01284439233635617
Starting epoch 46
17500 0.02678671417115307
17600 0.015077779493310193
17700 0.008392870270935979
17800 0.050853234183316956
Starting epoch 47
17900 0.012484062162464192
18000 0.047557026909391294
Checking training accuracy ... 
train accuracy is 0.987166314092878
Checking validation accuracy ...
val accuracy is  0.8782966368255505
total counted in batch average is 124.94383149448345
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_18.pt
18100 0.02910932726281617
18200 0.022606506938687175
Starting epoch 48
18300 0.010719924171901245
18400 0.022063363371355556
18500 0.010256648612954698
18600 0.008764086117105158
Starting epoch 49
18700 0.01038510812530854
18800 0.018572493505295315
18900 0.016598986836148064
19000 0.02186261944541282
Checking training accuracy ... 
train accuracy is 0.9990329404653974
Checking validation accuracy ...
val accuracy is  0.9045084280990402
total counted in batch average is 124.85370741482966
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_19.pt
Starting epoch 50
19100 0.00978942092941047
19200 0.010864062408475072
19300 0.020661053616815295
Starting epoch 51
19500 0.03672070390475595
19600 0.020910913240394877
19700 0.2618777774318961
Starting epoch 52
19800 0.04794047684528943
19900 0.01684611530955906
20000 0.009808397416092152
Checking training accuracy ... 
train accuracy is 0.9956482320942883
Checking validation accuracy ...
val accuracy is  0.8761190418582143
total counted in batch average is 124.39317953861585
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_20.pt
20100 0.01797830531342371
Starting epoch 53
20200 0.024919283765969757
20300 0.04390612784162322
20400 0.057355542947666274
20500 0.05780259397682155
Starting epoch 54
20600 0.14683503645471976
20700 0.020983666151439196
20800 0.01936302602861237
20900 0.02282865756713486
Starting epoch 55
21000 0.013533886513393413
Checking training accuracy ... 
train accuracy is 0.999274705349048
Checking validation accuracy ...
val accuracy is  0.8736994918945076
total counted in batch average is 124.94884653961886
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_21.pt
21100 0.014268553330392574
21200 0.008009256612964668
21300 0.026890478143537774
Starting epoch 56
21400 0.01720329750146698
21500 0.0754549515944277
21600 0.020557993156829806
21700 0.03156699854822386
Starting epoch 57
21800 0.021283816748822782
21900 0.039071080529524085
22000 0.014319055421980111
Checking training accuracy ... 
train accuracy is 0.9990127933917599
Checking validation accuracy ...
val accuracy is  0.8926526332768772
total counted in batch average is 125.30160320641282
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_22.pt
22100 0.008875348909089793
Starting epoch 58
22200 0.031187204148596295
22300 0.02243319259608018
22400 0.006288708580928539
22500 0.03197077775222054
Starting epoch 59
22600 0.014985488348962796
22700 0.016935723546390554
22800 0.019686135293695842
Starting epoch 60
22900 0.01688052664183795
23000 0.01583059071821301
Checking training accuracy ... 
train accuracy is 0.9979449984889694
Checking validation accuracy ...
val accuracy is  0.8270828292604242
total counted in batch average is 125.63991975927783
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t06_23.pt
23100 0.010812650169046185
23200 0.0206099908293334
Starting epoch 61
23300 0.014821824923915925
