SLURM_JOBID=3789587
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam4
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3.pt
Entropy threshold 0.3
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.1255529221694087
200 0.1163943417838891
300 0.13046886425989215
Starting epoch 2
400 0.11494313647206582
500 0.14548214665839623
600 0.1931285096965439
700 0.18662142346129257
Starting epoch 3
800 0.14585566513891535
900 0.36505028480751206
1000 0.23919328812047752
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.9778986602196031
Checking validation accuracy ...
val accuracy is  0.8554722155012501
total counted in batch average is 121.20140280561122
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_1.pt
1100 0.09678330744476625
Starting epoch 4
1200 0.16216226926268063
1300 0.16689284457394934
1400 0.13818129915058308
1500 0.13794786862883485
Starting epoch 5
1600 0.1856279629132041
1700 0.1580673756069899
1800 0.221598067439013
1900 0.18320640224132148
Starting epoch 6
2000 0.15914419142514816
Checking training accuracy ... 
train accuracy is 0.989060139014808
Checking validation accuracy ...
val accuracy is  0.8900717799822566
total counted in batch average is 123.90270812437312
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_2.pt
2100 0.11831537631159109
2200 0.1621246604901941
2300 0.17942991151413026
Starting epoch 7
2400 0.20661355035953421
2500 0.20959655046296122
2600 0.16915174138822864
2700 0.19287346733768004
Starting epoch 8
2800 0.16758104644216815
2900 0.17964606214467949
3000 0.31374831252294827
Checking training accuracy ... 
train accuracy is 0.9861992545582754
Checking validation accuracy ...
val accuracy is  0.8753931768691023
total counted in batch average is 124.5190380761523
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_3.pt
3100 0.11499309507957065
Starting epoch 9
3200 0.16866343899592295
3300 0.16132031963154986
3400 0.132163270569165
Starting epoch 10
3500 0.291602784270799
3600 0.21385763705515212
3700 0.20945876793074603
3800 0.16546580968683655
Starting epoch 11
3900 0.23161043973757842
4000 0.13865963204484616
Checking training accuracy ... 
train accuracy is 0.9858366072327994
Checking validation accuracy ...
val accuracy is  0.8717638519235422
total counted in batch average is 124.22768304914744
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_4.pt
4100 0.1869739251015615
4200 0.20889180814748443
Starting epoch 12
4300 0.23636381308198906
4400 0.17207203666583967
4500 0.14083889620648804
4600 0.09858073749891812
Starting epoch 13
4700 0.2282546939088161
4800 0.10336289726772627
4900 0.21651698048016044
5000 0.17528089939508618
Checking training accuracy ... 
train accuracy is 0.9732648332829656
Checking validation accuracy ...
val accuracy is  0.7858698282119526
total counted in batch average is 124.85370741482966
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_5.pt
Starting epoch 14
5100 0.1512733896464846
5200 0.31619390279029175
5300 0.17593507019922255
5400 0.12115333713390837
Starting epoch 15
5500 0.16226924452830105
5600 0.20227304516791306
5700 0.1342424206758278
5800 0.16564968872983546
Starting epoch 16
5900 0.09830859280994166
6000 0.09410463309437858
Checking training accuracy ... 
train accuracy is 0.9923441120177294
Checking validation accuracy ...
val accuracy is  0.8632954270505686
total counted in batch average is 124.73520561685055
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_6.pt
6100 0.18270330096996532
6200 0.11731973113400898
Starting epoch 17
6300 0.17837568054942
6400 0.11425759101025879
6500 0.14680680446053537
Starting epoch 18
6600 0.17011485326564085
6700 0.15089423426942175
6800 0.2500612044975177
6900 0.26783035224349194
Starting epoch 19
7000 0.17653569249018516
Checking training accuracy ... 
train accuracy is 0.99159867029314
Checking validation accuracy ...
val accuracy is  0.8578917654649568
total counted in batch average is 124.79839518555667
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_7.pt
7100 0.18386782423293468
7200 0.22224756413345972
7300 0.3473721082683187
Starting epoch 20
7400 0.26495317237871524
7500 0.20962514155552583
7600 0.16990036893955815
7700 0.12194380720492998
Starting epoch 21
7800 0.25926760694923073
7900 0.15676301261590767
8000 0.15318703683704613
Checking training accuracy ... 
train accuracy is 0.9891004331620832
Checking validation accuracy ...
val accuracy is  0.8380514557625615
total counted in batch average is 124.91282565130261
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_8.pt
8100 0.14941796614147676
Starting epoch 22
8200 0.13918969375405016
8300 0.22445417683517377
8400 0.2234916734199586
8500 0.17018468629132022
Starting epoch 23
8600 0.20437568054049
8700 0.27368165391733723
8800 0.15742511125623349
8900 0.13528578555408033
Starting epoch 24
9000 0.26752028218901613
Checking training accuracy ... 
train accuracy is 0.9830764581444545
Checking validation accuracy ...
val accuracy is  0.8025647229615291
total counted in batch average is 124.91875626880642
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_9.pt
9100 0.14831760151461598
9200 0.20335887101921585
9300 0.2061369580632375
Starting epoch 25
9400 0.10468613530637297
9500 0.17657024278203054
9600 0.14776109334583837
Starting epoch 26
9800 0.4723015860550834
9900 0.22380635319725115
10000 0.2773222732591074
Checking training accuracy ... 
train accuracy is 0.9825324871562405
Checking validation accuracy ...
val accuracy is  0.821275909347528
total counted in batch average is 125.21843687374749
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_10.pt
Starting epoch 27
10100 0.17767130904349215
10200 0.1471579053183541
10300 0.11282137067198107
10400 0.09716369245698324
Starting epoch 28
10500 0.1553338767972194
10600 0.186371961166876
10700 0.22495125922466144
10800 0.19101001093539366
Starting epoch 29
10900 0.14234607864017748
11000 0.15771299247873458
Checking training accuracy ... 
train accuracy is 0.9784829253550922
Checking validation accuracy ...
val accuracy is  0.7663521251713847
total counted in batch average is 125.23370110330993
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_11.pt
11100 0.21710989486447832
11200 0.20061148301271486
Starting epoch 30
11300 0.17724710487169715
11400 0.14734709103395643
11500 0.12605765418824078
11600 0.1420435304917123
Starting epoch 31
11700 0.2384863959139283
11800 0.29070781145605795
11900 0.2198740463594494
12000 0.1570306359007195
Checking training accuracy ... 
train accuracy is 0.9895638158557469
Checking validation accuracy ...
val accuracy is  0.7947415114122106
total counted in batch average is 125.09418837675351
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_12.pt
Starting epoch 32
12100 0.19961053094590794
12200 0.17086023142306922
12300 0.2785172925632373
12400 0.29776953750596474
Starting epoch 33
12500 0.17932720393842685
12600 0.14919973816783036
12700 0.12599705463166275
12800 0.1768614372538081
Starting epoch 34
12900 0.10503713147274964
13000 0.22947300104292878
Checking training accuracy ... 
train accuracy is 0.9746751284375944
Checking validation accuracy ...
val accuracy is  0.7470763771271877
total counted in batch average is 125.24974924774322
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_13.pt
13100 0.21892789074870184
Starting epoch 35
13200 0.19616225039597748
13300 0.19003843252194158
13400 0.13930769350254443
13500 0.11450892721548576
Starting epoch 36
13600 0.15008668029824854
13700 0.15995388268337093
13800 0.1872229371871234
13900 0.17137609061344
Starting epoch 37
14000 0.1295964874525432
Checking training accuracy ... 
train accuracy is 0.9935529364359826
Checking validation accuracy ...
val accuracy is  0.747640938785386
total counted in batch average is 125.74222668004012
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_14.pt
14100 0.0897667844602222
14200 0.281949924341132
14300 0.21813615234815828
Starting epoch 38
14400 0.22719681025471344
14500 0.17081339644750734
14600 0.1845415248541974
14700 0.1560550784717357
Starting epoch 39
14800 0.22381457024077356
14900 0.3062766963522401
15000 0.35308190599201905
Checking training accuracy ... 
train accuracy is 0.976730129948625
Checking validation accuracy ...
val accuracy is  0.7325590773449472
total counted in batch average is 125.71543086172345
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_15.pt
15100 0.25671039355557207
Starting epoch 40
15200 0.16487523749409252
15300 0.12682307443861693
15400 0.18134189412137314
15500 0.1930398985594367
Starting epoch 41
15600 0.2815946645871098
15700 0.21653242591495275
15800 0.13665010703753125
15900 0.19863264507210426
Starting epoch 42
16000 0.23654484701054435
Checking training accuracy ... 
train accuracy is 0.9874080789765287
Checking validation accuracy ...
val accuracy is  0.7343334139849987
total counted in batch average is 125.67502507522568
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_16.pt
16100 0.1667276136633955
16200 0.12002202495463479
Starting epoch 43
16300 0.13137686818051497
16400 0.18349840661822991
16500 0.13599298476491592
16600 0.120122532880575
Starting epoch 44
16700 0.16806798708608572
16800 0.14508912014018308
16900 0.17825841254286004
17000 0.1935327572312457
Checking training accuracy ... 
train accuracy is 0.991276317114939
Checking validation accuracy ...
val accuracy is  0.7363497056214211
total counted in batch average is 125.64028056112224
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_17.pt
Starting epoch 45
17100 0.17886225758857324
17200 0.2034701674672936
17300 0.22435615521433477
17400 0.18536009295221667
Starting epoch 46
17500 0.14990172110651026
17600 0.1738537474254268
17700 0.14004329559642936
17800 0.18985353794147408
Starting epoch 47
17900 0.16279794124866778
18000 0.17349986808364612
Checking training accuracy ... 
train accuracy is 0.9860783721164501
Checking validation accuracy ...
val accuracy is  0.7403016372288088
total counted in batch average is 125.5616850551655
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_18.pt
18100 0.20237349874685226
18200 0.1554795941443096
Starting epoch 48
18300 0.15877915590085803
18400 0.19013351465282968
18500 0.15642298054514492
18600 0.15305488520907606
Starting epoch 49
18700 0.15226913467752815
18800 0.2136067822387943
18900 0.2324262057677284
19000 0.18572318011979597
Checking training accuracy ... 
train accuracy is 0.9922433766495417
Checking validation accuracy ...
val accuracy is  0.7417533672070328
total counted in batch average is 125.6132264529058
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_19.pt
Starting epoch 50
19100 0.15217355075528716
19200 0.17366947616978526
19300 0.18663815080675178
Starting epoch 51
19500 0.3807930245348741
19600 0.15579649278177585
19700 0.16425940244097917
Starting epoch 52
19800 0.20490406926724553
19900 0.23181333629856282
20000 0.15243149108110235
Checking training accuracy ... 
train accuracy is 0.9821899869044022
Checking validation accuracy ...
val accuracy is  0.7594160819420921
total counted in batch average is 125.52056168505517
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_20.pt
20100 0.2100056741414108
Starting epoch 53
20200 0.21953600146371627
20300 0.2006311612959143
20400 0.20215539789046247
20500 0.17285728637805342
Starting epoch 54
20600 0.16390454240025437
20700 0.18406225350928626
20800 0.10631667816751125
20900 0.30045400667255157
Starting epoch 55
21000 0.151976178647714
Checking training accuracy ... 
train accuracy is 0.989745139518485
Checking validation accuracy ...
val accuracy is  0.7289297523993871
total counted in batch average is 125.80441323971915
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_21.pt
21100 0.14593428666925265
21200 0.13564449619023228
21300 0.24046295440989085
Starting epoch 56
21400 0.21565340913107037
21500 0.2200610432173278
21600 0.1811051156726495
21700 0.15091335149285798
Starting epoch 57
21800 0.21332897618749824
21900 0.18669419340497928
22000 0.16628363066990087
Checking training accuracy ... 
train accuracy is 0.9911957288203889
Checking validation accuracy ...
val accuracy is  0.73715622227599
total counted in batch average is 126.03507014028057
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_22.pt
22100 0.1618108781701354
Starting epoch 58
22200 0.12609706650908348
22300 0.18824108239475648
22400 0.16624657462921377
22500 0.13441585354910257
Starting epoch 59
22600 0.1191833269740019
22700 0.1314569300750347
22800 0.18756162563975187
Starting epoch 60
22900 0.19893558169488246
23000 0.13314211670855866
Checking training accuracy ... 
train accuracy is 0.9919008763977032
Checking validation accuracy ...
val accuracy is  0.7544156786837648
total counted in batch average is 126.04714142427282
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t3_23.pt
23100 0.3236917704233373
23200 0.3251177887280868
Starting epoch 61
23300 0.16225215556461883
