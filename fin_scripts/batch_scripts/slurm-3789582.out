SLURM_JOBID=3789582
SLURM_JOB_NAME=filmreconcontrastive
SLURM_JOB_NODELIST=viscam2
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /viscam/u/joycj/dvr/fin_code/film/fin_scripts/batch_scripts
/viscam/u/joycj/dvr/fin_code/film/vr/models/layers.py:141: UserWarning: nn.init.kaiming_uniform is now deprecated in favor of nn.init.kaiming_uniform_.
  init_params(m.weight)
Will save checkpoints to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001.pt
Entropy threshold 0.001
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/train/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object_biased_005/questions/train/what_attr_is_the_attr_questions.h5
Reading question data into memory
Reading features from /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/features.h5
Reading questions from  /viscam/u/joycj/dvr/final_datasets/cogen_multi_object/questions/test/what_attr_is_the_attr_questions.h5
Reading question data into memory
Loading FiLMGen from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioning network:
FiLMGen(
  (encoder_embed): Embedding(27, 200)
  (encoder_rnn): GRU(200, 4096, batch_first=True)
  (decoder_linear): Linear(in_features=4096, out_features=1024, bias=True)
)
Loading FiLMReconContrastiveIntermediate from /viscam/u/joycj/dvr/film/checkpoint_paths/stage_1_film_moma_attr_ans_cogen_biased_005_78.pt
Here is the conditioned network:
FiLMedNetReconContrastiveIntermediate(
  (stem): Sequential(
    (0): Conv2d(1026, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (0): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (1): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (2): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (3): FiLMedResBlock(
    (input_proj): Conv2d(130, 128, kernel_size=(1, 1), stride=(1, 1))
    (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
    (film): FiLM()
  )
  (bottleneck_classifier): Sequential(
    (0): Conv2d(130, 512, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=14, stride=14, padding=0, dilation=1, ceil_mode=False)
    (4): Flatten()
    (5): Linear(in_features=512, out_features=1024, bias=True)
    (6): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU(inplace=True)
    (8): Linear(in_features=1024, out_features=16, bias=True)
  )
  (pred_classifier): Linear(in_features=16, out_features=19, bias=True)
)
train_loader has 49635 samples
val_loader has 12399 samples
real_loader has 2000 samples
/viscam/u/joycj/dvr/final_datasets/cogen_multi_object/test/CLEVR_scenes.json
Starting epoch 1
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:398: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  p = torch.nn.Softmax()(recon_scores)
100 0.003941356176410409
200 0.0016626787888480976
300 0.0003394191811366909
Starting epoch 2
400 0.009836854199759272
500 0.004839820774595865
600 0.004134460050952384
700 0.0028685897400919204
Starting epoch 3
800 0.00020996310801933758
900 9.360588108620505e-05
1000 0.004557478887229536
Checking training accuracy ... 
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:784: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  questions_var = Variable(questions.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:785: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  feats_var = Variable(feats.cuda(), volatile=True)
/viscam/u/joycj/dvr/fin_code/film/fin_scripts/train_sampler.py:786: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  answers_var = Variable(feats.cuda(), volatile=True)
train accuracy is 0.9954266142842753
Checking validation accuracy ...
val accuracy is  0.9337043309944351
total counted in batch average is 81.06312625250501
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_1.pt
1100 0.00421430325132178
Starting epoch 4
1200 0.001830573870875014
1300 0.001293046465715406
1400 0.0014987128115194538
1500 0.017715937623866012
Starting epoch 5
1600 0.0027385291139603394
1700 0.0011815221831193413
1800 0.003666547551301278
1900 0.0010718916830771263
Starting epoch 6
2000 0.0014015474598340915
Checking training accuracy ... 
train accuracy is 0.9987508814344717
Checking validation accuracy ...
val accuracy is  0.9459633841438826
total counted in batch average is 86.27482447342027
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_2.pt
2100 0.00323409100285005
2200 0.003456017811025731
2300 0.006767611434577247
Starting epoch 7
2400 0.0022036978014602937
2500 0.0027471440107331093
2600 0.0038695388194969382
2700 0.0022326515950010163
Starting epoch 8
2800 0.00207012605877253
2900 0.002301495894094501
3000 0.0007091554692857471
Checking training accuracy ... 
train accuracy is 0.999818676337262
Checking validation accuracy ...
val accuracy is  0.9407210258891846
total counted in batch average is 88.67735470941884
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_3.pt
3100 9.242148708011654e-05
Starting epoch 9
3200 0.0017020810755997218
3300 8.243349851142057e-05
3400 0.007598688738564761
Starting epoch 10
3500 0.006137286731368477
3600 0.001124830577711009
3700 0.0025015309266353826
3800 0.002162169057274923
Starting epoch 11
3900 0.008356396638686193
4000 0.0010318771534124948
Checking training accuracy ... 
train accuracy is 0.9999798529263625
Checking validation accuracy ...
val accuracy is  0.9429792725219776
total counted in batch average is 91.6690070210632
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_4.pt
4100 4.5182534132095496e-05
4200 0.0016407240975323135
Starting epoch 12
4300 0.001170444483057338
4400 0.00015598866569064285
4500 0.0005842283217443623
4600 0.010462610046531609
Starting epoch 13
4700 0.00922371007845527
4800 0.0036683585253797445
4900 0.003331971177028379
5000 0.0061955791369848615
Checking training accuracy ... 
train accuracy is 0.9996977938954367
Checking validation accuracy ...
val accuracy is  0.9388660375836761
total counted in batch average is 94.28256513026052
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_5.pt
Starting epoch 14
5100 0.0004371767048974107
5200 0.00018161885085319796
5300 0.0037242589801033434
5400 0.001066675971633231
Starting epoch 15
5500 0.0005958305242873507
5600 3.179861890970415e-05
5700 0.0002937880928402592
5800 4.20034732314889e-05
Starting epoch 16
5900 7.857536157537481e-05
6000 1.3988230795760615e-05
Checking training accuracy ... 
train accuracy is 1.0
Checking validation accuracy ...
val accuracy is  0.9540285506895717
total counted in batch average is 98.76730190571715
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_6.pt
6100 6.616878402297743e-05
6200 2.867469861868699e-05
Starting epoch 17
6300 0.0012790286724310817
6400 0.014773722875132478
6500 0.00590715553602422
Starting epoch 18
6600 0.0014747997719561567
6700 0.0008779029180686848
6800 0.0014527483311560728
6900 0.003828750047622975
Starting epoch 19
7000 0.00157779572550794
Checking training accuracy ... 
train accuracy is 0.999637352674524
Checking validation accuracy ...
val accuracy is  0.9297523993870473
total counted in batch average is 97.21263791374122
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_7.pt
7100 0.0025594780584165732
7200 0.0018867559738654904
7300 0.004439819322458334
Starting epoch 20
7400 0.0021518466663172833
7500 0.0009485041679283768
7600 0.0017655591922866164
7700 0.0028196451419214698
Starting epoch 21
7800 0.0008174253970078383
7900 0.001660093690869946
8000 0.0006617005683268928
Checking training accuracy ... 
train accuracy is 0.9139921426412814
Checking validation accuracy ...
val accuracy is  0.8610371804177757
total counted in batch average is 99.18537074148297
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_8.pt
8100 0.003594732874598776
Starting epoch 22
8200 0.0007117707910272486
8300 0.00033910791485951107
8400 0.00204577938350468
8500 0.001739231015264835
Starting epoch 23
8600 0.003263194182235054
8700 0.00886283652200177
8800 0.004357042156157149
8900 0.0003777578177349028
Starting epoch 24
9000 0.00037380761723298405
Checking training accuracy ... 
train accuracy is 0.9999194117054497
Checking validation accuracy ...
val accuracy is  0.9445923058311154
total counted in batch average is 99.78234704112337
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_9.pt
9100 0.000615138110959208
9200 0.0020760104311145257
9300 0.00036424979044809904
Starting epoch 25
9400 0.002162729274523372
9500 0.001967532709557673
9600 0.004558470566339849
Starting epoch 26
9800 0.004423418408794859
9900 0.002174131104677741
10000 0.003385450285587126
Checking training accuracy ... 
train accuracy is 0.9990732346126725
Checking validation accuracy ...
val accuracy is  0.9365271392854262
total counted in batch average is 102.03006012024048
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_10.pt
Starting epoch 27
10100 0.003166088980973285
10200 0.0013871879663358655
10300 0.0013649268721327701
10400 0.0020525800825824804
Starting epoch 28
10500 0.003720127268085207
10600 0.0037622190220074005
10700 0.0007693638303767614
10800 0.0003254937521165857
Starting epoch 29
10900 0.002336318933458088
11000 7.97362909978716e-05
Checking training accuracy ... 
train accuracy is 0.9999597058527249
Checking validation accuracy ...
val accuracy is  0.9466085974675377
total counted in batch average is 100.98696088264795
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_11.pt
11100 0.0006807990495177308
11200 0.0015483084961478255
Starting epoch 30
11300 0.001752491968381662
11400 0.00035596944237383356
11500 3.848156881268494e-05
11600 0.0005661151787990981
Starting epoch 31
11700 9.41011606226283e-06
11800 0.001316077089490566
11900 0.008407847567442275
12000 0.005590890124138923
Checking training accuracy ... 
train accuracy is 0.9995366173063363
Checking validation accuracy ...
val accuracy is  0.9305589160416162
total counted in batch average is 105.98296593186373
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_12.pt
Starting epoch 32
12100 0.00599909374439676
12200 0.0013662837984972497
12300 0.004474416015834493
12400 0.0014882446942520034
Starting epoch 33
12500 0.000982415759931712
12600 0.002277448266193147
12700 0.0003742786062079517
12800 0.0012019421601269188
Starting epoch 34
12900 0.0009801766370326171
13000 0.007954866163327096
Checking training accuracy ... 
train accuracy is 0.9969376448070918
Checking validation accuracy ...
val accuracy is  0.9450762158238568
total counted in batch average is 102.84152457372116
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_13.pt
13100 0.0025275441785878173
Starting epoch 35
13200 0.0013947768347696155
13300 5.381580780799311e-05
13400 0.0016775593861660099
13500 0.00010971111251002696
Starting epoch 36
13600 0.00011688684315966925
13700 2.5870956174731675e-05
13800 0.00032341114383379834
13900 0.008385308057086718
Starting epoch 37
14000 0.0021939483366080026
Checking training accuracy ... 
train accuracy is 0.9996574997481615
Checking validation accuracy ...
val accuracy is  0.935962577627228
total counted in batch average is 104.85356068204614
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_14.pt
14100 0.001919978154590467
14200 0.00012521294974291664
14300 0.00010229015974275057
Starting epoch 38
14400 7.537352717186252e-06
14500 5.498913194799116e-06
14600 1.5973808722513638e-06
14700 0.0013647891751581121
Starting epoch 39
14800 0.002027738135877968
14900 0.0028465596981155448
15000 3.638320608894574e-05
Checking training accuracy ... 
train accuracy is 0.9998992646318122
Checking validation accuracy ...
val accuracy is  0.9469312041293653
total counted in batch average is 109.3186372745491
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_15.pt
15100 0.0010401461855292914
Starting epoch 40
15200 0.007202038599188114
15300 0.005025216298529358
15400 0.004358042590496183
15500 0.001270396833045524
Starting epoch 41
15600 0.000140728926706295
15700 0.0003075838308241963
15800 0.0009730785292710209
15900 0.0002168690331844303
Starting epoch 42
16000 0.0005397066730902011
Checking training accuracy ... 
train accuracy is 0.9999798529263625
Checking validation accuracy ...
val accuracy is  0.9527381240422614
total counted in batch average is 105.44433299899698
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_16.pt
16100 7.842298431963712e-06
16200 3.902012579691139e-05
Starting epoch 43
16300 8.79928143915798e-05
16400 0.001993333047841994
16500 0.006127667337078719
16600 0.003541310158142359
Starting epoch 44
16700 0.0010018744304411164
16800 0.00025741408302445203
16900 8.6419286300643e-06
17000 1.3642732369261167e-05
Checking training accuracy ... 
train accuracy is 0.9999798529263625
Checking validation accuracy ...
val accuracy is  0.9510444390676668
total counted in batch average is 109.562124248497
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_17.pt
Starting epoch 45
17100 5.7206750444827036e-06
17200 0.00040685542939521645
17300 0.005640460786628978
17400 0.004059792862477636
Starting epoch 46
17500 0.0003725446871803495
17600 0.0019311021158257002
17700 5.0318887870801635e-05
17800 0.002020410042681284
Starting epoch 47
17900 0.001548034327492509
18000 0.007094101879125461
Checking training accuracy ... 
train accuracy is 0.9991941170544978
Checking validation accuracy ...
val accuracy is  0.9448342608274861
total counted in batch average is 108.00300902708125
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_18.pt
18100 0.0006277554223500203
18200 0.0015810923556326983
Starting epoch 48
18300 2.1789704676606903e-05
18400 1.3862967904252343e-05
18500 1.541778395928617e-05
18600 1.824211150359023e-05
Starting epoch 49
18700 8.74166460991077e-05
18800 0.0019236335556488094
18900 0.00039432214371100117
19000 0.0031986064417744943
Checking training accuracy ... 
train accuracy is 0.9995366173063363
Checking validation accuracy ...
val accuracy is  0.953060730704089
total counted in batch average is 111.58517034068136
Saving checkpoint to /viscam/u/joycj/dvr/film/chckpt_paths/appendix_biased_005_film_moma_attr_ans_cogen_biased_005_78_sampler_t001_19.pt
Starting epoch 50
19100 0.004374094536819655
19200 0.011113801247939677
19300 0.0017793077878877738
Starting epoch 51
19500 0.00511588076733478
19600 0.0019118811549947879
19700 0.0010583652255465737
Starting epoch 52
19800 0.0029127778768291536
19900 0.0010984783689130496
